import{_ as s,c as a,o as i,a0 as t}from"./chunks/framework.8DCkquxJ.js";const h=JSON.parse('{"title":"8. Modificació","description":"","frontmatter":{},"headers":[],"relativePath":"8-modificacio.md","filePath":"8-modificacio.md"}'),n={name:"8-modificacio.md"};function l(r,e,o,d,p,c){return i(),a("div",null,e[0]||(e[0]=[t(`<h1 id="_8-modificacio" tabindex="-1">8. Modificació <a class="header-anchor" href="#_8-modificacio" aria-label="Permalink to &quot;8. Modificació&quot;">​</a></h1><p>Per a poder modificar les dades que conté un ResultSet necessitem un ResultSet de tipus modificable. Per a això hem d&#39;utilitzar la constant ResultSet.CONCUR_UPDATABLE en cridar al mètode createStatement() com s&#39;ha vist abans.</p><p><strong>Per a modificar els valors d&#39;un registre existent s&#39;utilitzen una sèrie de mètodes updateXXX()</strong> de ResultSet . Les XXX indiquen el tipus de la dada i hi ha tants diferents com succeeix amb els mètodes getXXX() d&#39;aquesta mateixa interfície: <strong>updateString()</strong>, <strong>updateInt()</strong>, <strong>updateDouble()</strong>, <strong>updateDate()</strong>, etc.</p><p>La diferència és que <strong>els mètodes updateXXX() necessiten dos arguments</strong>:</p><ul><li><strong>La columna que desitgem actualitzar</strong> (pel seu nom o pel seu número de columna).</li><li><strong>El valor que volem emmagatzemar</strong> en aquesta columna (del tipus que siga).</li></ul><p>Per exemple per a modificar el camp ‘edat’ emmagatzemant el sencer 28 caldria cridar al següent mètode, suposant que rs és un objecte ResultSet:</p><p><code>rs.updateInt(&quot;edat&quot;, 28);</code></p><p>També podria fer-se de la següent manera, suposant que la columna “edat” és la segona:</p><p><code>rs.updateInt(2, 28);</code></p><p>Els mètodes updateXXX() no retornen cap valor (són de tipus void). Si es produeix algun error es llançarà una SQLException.</p><p>Posteriorment <strong>cal cridar a updateRow() perquè els canvis realitzats s&#39;apliquen sobre la base de dades</strong>. El Driver JDBC s&#39;encarregarà d&#39;executar les sentències SQL necessàries. Aquesta és una característica molt potent ja que ens facilita enormement la tasca de modificar les dades d&#39;una base de dades. Aquest mètode retorna void.</p><p>En resum, el procés per a realitzar la modificació d&#39;una fila d&#39;un ResultSet és el següent:</p><ol><li><strong>Desplacem el cursor al registre</strong> que volem modificar.</li><li>Cridem a tots els mètodes <strong>updateXXX(...)</strong> que necessitem.</li><li>Cridem a updateRow() perquè els canvis s&#39;apliquen a la base de dades.</li></ol><p>És important entendre que <strong>cal cridar a updateRow() abans de desplaçar el cursor</strong>. Si desplacem el cursor abans de cridar a updateRow(), es perdran els canvis. Si volem <strong>cancel·lar les modificacions d&#39;un registre del ResultSet</strong> podem cridar a <strong>cancelRowUpdates()</strong>, que cancel·la totes les modificacions realitzades sobre el registre actual. Si ja hem anomenat a updateRow() el mètode cancelRowUpdates() no tindrà cap efecte.</p><p>El següent codi d&#39;exemple mostra com modificar el camp ‘direcció’ de l&#39;últim registre d&#39;un ResultSet que conté el resultat d&#39;un SELECT sobre la taula de clients. Suposarem que conn és un objecte Connection previament creat:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Creem un Statement scrollable i modificable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Statement stmt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Executem un SELECT i obtenim la taula clients en un ResultSet</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM clients&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ResultSet rs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sql);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Anem a l&#39;últim registre, el modifiquem i actualitzem la base de dades</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">last</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;direccio&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;C/ Pepe Ciges, 3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div>`,16)]))}const m=s(n,[["render",l]]);export{h as __pageData,m as default};
