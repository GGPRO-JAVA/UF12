import{_ as i,c as a,o as e,a0 as n}from"./chunks/framework.8DCkquxJ.js";const d=JSON.parse('{"title":"9. Inserció","description":"","frontmatter":{},"headers":[],"relativePath":"9-insercio.md","filePath":"9-insercio.md"}'),t={name:"9-insercio.md"};function l(r,s,p,h,k,o){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="_9-insercio" tabindex="-1">9. Inserció <a class="header-anchor" href="#_9-insercio" aria-label="Permalink to &quot;9. Inserció&quot;">​</a></h1><p>Per a inserir nous registres necessitarem utilitzar, almenys, aquests dos mètodes:</p><ul><li><strong>void moveToInsertRow()</strong>: Desplaça el cursor al ‘registre d&#39;inserció’. És un registre especial utilitzat per a inserir nous registres en el ResultSet. Posteriorment tindrem que cridar als mètodes updateXXX() ja coneguts per a establir els valors del registre d&#39;inserció. Per a finalitzar cal cridar a insertRow().</li><li><strong>void insertRow()</strong>: Inserida el ‘registre d&#39;inserció’ en el ResultSet, passant a ser un registre normal més, i també l&#39;insereix en la base de dades.</li></ul><p>El següent codi inserix un nou registre en la taula ‘clients’. Suposarem que conn és un objecte Connection previament creat:</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Creem un Statement scrollable i modificable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Statement stmt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> conn.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createStatement</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Executem un SELECT i obtenim la taula clients en un ResultSet</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">String sql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;SELECT * FROM clients&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ResultSet rs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">executeQuery</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sql);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Creem un nou registre i l&#39;inserim</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">moveToInsertRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Killy Lopez&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Wall Street 3674&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">insertRow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><p>Els camps el valor dels quals no s&#39;haja establit amb updateXXX() tindran un valor NULL. Si en la base de dades aquest camp no està configurat per a admetre nuls es produirà una SQLException.</p><p>Després d&#39;inserir el nostre nou registre en l&#39;objecte ResultSet podrem tornar a l&#39;anterior posició en la qual es trobava el cursor (abans d&#39;invocar moveToInsertRow()) cridant al mètode moveToCurrentRow(). Aquest mètode només es pot utilitzar en combinació amb moveToInsertRow().</p>`,7)]))}const c=i(t,[["render",l]]);export{d as __pageData,c as default};
