import{_ as k,C as t,c as h,o,j as s,G as a,a as e,w as l}from"./chunks/framework.sQ8wSw9M.js";const F=JSON.parse('{"title":"9. Inserció","description":"","frontmatter":{},"headers":[],"relativePath":"9-insercio.md","filePath":"9-insercio.md"}'),d={name:"9-insercio.md"};function E(p,i,u,g,c,m){const n=t("PluginTabsTab"),r=t("PluginTabs");return o(),h("div",null,[i[1]||(i[1]=s("h1",{id:"_9-insercio",tabindex:"-1"},[e("9. Inserció "),s("a",{class:"header-anchor",href:"#_9-insercio","aria-label":'Permalink to "9. Inserció"'},"​")],-1)),i[2]||(i[2]=s("p",null,"Per a inserir nous registres necessitarem utilitzar, almenys, aquests dos mètodes:",-1)),i[3]||(i[3]=s("ul",null,[s("li",null,[s("strong",null,"void moveToInsertRow()"),e(": Desplaça el cursor al ‘registre d'inserció’. És un registre especial utilitzat per a inserir nous registres en el ResultSet. Posteriorment tindrem que cridar als mètodes updateXXX() ja coneguts per a establir els valors del registre d'inserció. Per a finalitzar cal cridar a insertRow().")]),s("li",null,[s("strong",null,"void insertRow()"),e(": Inserida el ‘registre d'inserció’ en el ResultSet, passant a ser un registre normal més, i també l'insereix en la base de dades.")])],-1)),i[4]||(i[4]=s("p",null,"El següent codi inserix un nou registre en la taula ‘clients’. Suposarem que conn és un objecte Connection previament creat:",-1)),a(r,null,{default:l(()=>[a(n,{label:"Java"},{default:l(()=>i[0]||(i[0]=[s("div",{class:"language-java vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"java"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// Creem un Statement scrollable i modificable")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Statement stmt "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," conn."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"createStatement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// Executem un SELECT i obtenim la taula clients en un ResultSet")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"String sql "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "SELECT * FROM clients"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ResultSet rs "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," stmt."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"executeQuery"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(sql);")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// Creem un nou registre i l'inserim")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rs."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"moveToInsertRow"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rs."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"updateString"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Killy Lopez"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rs."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"updateString"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Wall Street 3674"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rs."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"insertRow"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")])])])],-1)])),_:1,__:[0]})]),_:1}),i[5]||(i[5]=s("p",null,"Els camps el valor dels quals no s'haja establit amb updateXXX() tindran un valor NULL. Si en la base de dades aquest camp no està configurat per a admetre nuls es produirà una SQLException.",-1)),i[6]||(i[6]=s("p",null,"Després d'inserir el nostre nou registre en l'objecte ResultSet podrem tornar a l'anterior posició en la qual es trobava el cursor (abans d'invocar moveToInsertRow()) cridant al mètode moveToCurrentRow(). Aquest mètode només es pot utilitzar en combinació amb moveToInsertRow().",-1))])}const b=k(d,[["render",E]]);export{F as __pageData,b as default};
